# Name your project! Project names should contain only lowercase characters
# and underscores. A good package name should reflect your organization's
# name or the intended use of these models
name: "my_new_project"
version: "1.0.0"
config-version: 2

# This setting configures which "profile" dbt uses for this project.
profile: "default"

# These configurations specify where dbt should look for different types of files.
# The `model-paths` config, for example, states that models in this project can be
# found in the "models/" directory. You probably won't need to change these!
model-paths: ["models"]
analysis-paths: ["analyses"]
test-paths: ["tests"]
seed-paths: ["seeds"]
macro-paths: ["macros"]
snapshot-paths: ["snapshots"]

target-path: "target" # directory which will store compiled SQL files
clean-targets: # directories to be removed by `dbt clean`
  - "target"
  - "dbt_packages"

# Configuring models
# Full documentation: https://docs.getdbt.com/docs/configuring-models

# In dbt, the default materialization for a model is a view. This means, when you run
# dbt run or dbt build, all of your models will be built as a view in your data platform.
# The configuration below will override this setting for models in the example folder to
# instead be materialized as tables. Any models you add to the root of the models folder will
# continue to be built as views. These settings can be overridden in the individual model files
# using the `{{ config(...) }}` macro.

models:
  +transient: false

  curso:
    staging:
      +materialized: view
      +database: |
        {%- if  target.name == 'user_dev' -%} ALUMNO29_DEV_SILVER_DB 
        {%- elif target.name == 'ci' -%} ALUMNO29_DEV_SILVER_DB 
        {%- elif target.name == 'pro'-%} ALUMNO29_PRO_SILVER_DB  
        {%- else -%} _ALUMNO29_{{target.database}}_SILVER_DB
        {%- endif -%}
      tags: ["SILVER"]

      google_sheets:
        +schema: google_sheets

      sql_server:
        +schema: sql_server
        base:
          +docs:
            node_color: "#C39BD3"
          tags: ["BASES"]
        stages:
          +docs:
            node_color: "#5DADE2"
          tags: ["STAGES"]

      core:
        +schema: core
    marts:
      +materialized: table
      +database: |
        {%- if  target.name == 'user_dev' -%} ALUMNO29_DEV_GOLD_DB 
        {%- elif target.name == 'ci' -%} ALUMNO29_DEV_GOLD_DB 
        {%- elif target.name == 'pro'-%} ALUMNO29_PRO_SILVER_DB  
        {%- else -%} _ALUMNO29_{{target.database}}_GOLD_DB
        {%- endif -%}
      tags: ["GOLD"]
      core:
        +schema: core
        dims:
          tags: ["DIMS"]
          +docs:
            node_color: "#82E0AA"
        Facts_tables:
          tags: ["FACT_TABLE"]
          +docs:
            node_color: "#F4D03F"

      distintas_areas:
        +schema: distintas_areas
      intermediate:
        +schema: intermediate
        tags: ["INTERMEDIATE"]
        +docs:
        node_color: "#D35400"

seeds:
    +transient: true
    +database: |
      {%- if  target.name == 'user_dev' -%} ALUMNO29_DEV_SILVER_DB 
      {%- elif target.name == 'ci' -%} ALUMNO29_DEV_SILVER_DB 
      {%- elif target.name == 'pro'-%} ALUMNO29_PRO_SILVER_DB  
      {%- else -%} _ALUMNO29_{{target.database}}_SILVER_DB
      {%- endif -%}

    +target_schema: seeds
    tags: ["SEED", "BRONZE"]
    +docs:
      node_color: "#48C9B0"

snapshots:
  +sql_header: "alter session set timezone = 'Europe/Madrid';alter session set week_start = 7;"
  +transient: true
  +target_database: |
      {%- if  target.name == 'user_dev' -%} ALUMNO29_DEV_SILVER_DB 
      {%- elif target.name == 'ci' -%} ALUMNO29_DEV_SILVER_DB 
      {%- elif target.name == 'pro'-%} ALUMNO29_PRO_SILVER_DB  
      {%- else -%} _ALUMNO29_{{target.database}}_SILVER_DB
      {%- endif -%}
  +target_schema: snapshots
  tags: ["SNAPSHOT"]
  +docs:
    node_color: "#E74C3C"
vars:
  "dbt_ml:audit_schema": "audit"
  "dbt_ml:audit_table": "ml_models"
